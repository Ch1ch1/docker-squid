kind: pipeline
type: docker
name: Building

steps:
- name: build & push
  image: plugins/docker
  settings:
    repo: ch1ch1/squid
    tags:
    - alpine3.12
    - latest
    username: ch1ch1
    password:
      from_secret: dockerhub-password
--
kind: pipeline
type: exec
name: Publish

clone:
  disable: true
trigger:
  status:
  - success
steps:
- name: Pull
  commands:
  - docker pull ch1ch1/squid
- name: Update
  commands:
  - service docker-squid restart
